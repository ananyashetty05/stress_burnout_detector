<!DOCTYPE html>
<html>
<head>
    <title>Early Stress & Burnout Detection Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.socket.io/4.4.1/socket.io.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; 
            background: #0a0a0a; 
            color: #e8e8e8; 
            line-height: 1.5; 
        }
        
        .header { 
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%); 
            padding: 30px 20px; 
            text-align: center; 
            border-bottom: 2px solid #333; 
        }
        .header h1 { 
            color: #4CAF50; 
            font-size: 2.5rem; 
            font-weight: 700; 
            margin-bottom: 8px; 
        }
        .header p { 
            color: #888; 
            font-size: 1.1rem; 
            margin-bottom: 20px; 
        }
        
        .stats-bar { 
            display: grid; 
            grid-template-columns: repeat(4, 1fr); 
            gap: 20px; 
            margin-top: 20px; 
        }
        .stat-card { 
            background: rgba(76, 175, 80, 0.1); 
            padding: 15px; 
            border-radius: 8px; 
            border: 1px solid #4CAF50; 
            text-align: center; 
        }
        .stat-value { 
            font-size: 1.8rem; 
            font-weight: 700; 
            color: #4CAF50; 
        }
        .stat-label { 
            font-size: 0.9rem; 
            color: #ccc; 
            margin-top: 4px; 
        }
        
        .dashboard-grid { 
            display: grid; 
            grid-template-columns: repeat(12, 1fr); 
            gap: 20px; 
            padding: 20px; 
            max-width: 1800px; 
            margin: 0 auto; 
        }
        
        .panel { 
            background: #1a1a1a; 
            border-radius: 12px; 
            padding: 20px; 
            border: 1px solid #333; 
            box-shadow: 0 4px 6px rgba(0,0,0,0.3); 
        }
        .panel h3 { 
            color: #4CAF50; 
            margin-bottom: 16px; 
            font-size: 1.2rem; 
            font-weight: 600; 
            display: flex; 
            align-items: center; 
            gap: 8px; 
        }
        
        .research-panel { grid-column: span 6; }
        .stress-detection { grid-column: span 6; }
        .emoji-module { grid-column: span 4; }
        .temporal-analysis { grid-column: span 4; }
        .alerts-panel { grid-column: span 4; }
        .emotion-distribution { grid-column: span 6; }
        .model-evaluation { grid-column: span 6; }
        .dataset-sentiment { grid-column: span 6; }
        .burnout-distribution { grid-column: span 6; }
        .sentiment-analysis { grid-column: span 6; }
        .temporal-recommendations { grid-column: span 6; }
        .user-input-panel { grid-column: span 6; }
        .user-stress-chart { grid-column: span 6; }
        .live-analysis-panel { grid-column: span 12; }
        .wellness-panel { grid-column: span 12; }
        
        .research-table { 
            width: 100%; 
            border-collapse: collapse; 
        }
        .research-table th, .research-table td { 
            padding: 10px; 
            text-align: left; 
            border-bottom: 1px solid #333; 
        }
        .research-table th { 
            color: #4CAF50; 
            font-weight: 600; 
        }
        .research-table td { 
            color: #ccc; 
            font-size: 0.9rem; 
        }
        
        .gauge-container { 
            position: relative; 
            width: 200px; 
            height: 120px; 
            margin: 10px auto 20px auto; 
        }
        .gauge { 
            width: 200px; 
            height: 100px; 
            border-radius: 100px 100px 0 0; 
            background: conic-gradient(from 180deg, #4CAF50 0deg, #FFC107 120deg, #FF5722 180deg); 
            position: relative; 
        }
        .gauge-needle { 
            position: absolute; 
            bottom: 0; 
            left: 50%; 
            width: 2px; 
            height: 80px; 
            background: #fff; 
            transform-origin: bottom; 
            transform: translateX(-50%) rotate(45deg); 
        }
        .stress-level-text {
            text-align: center;
            margin-top: 15px;
            font-size: 0.9rem;
            color: #e8e8e8;
        }
        
        .emoji-grid { 
            display: grid; 
            grid-template-columns: repeat(5, 1fr); 
            gap: 10px; 
            margin-top: 15px; 
        }
        .emoji-item { 
            background: #2a2a2a; 
            padding: 10px; 
            border-radius: 6px; 
            text-align: center; 
            border: 1px solid #444; 
        }
        .emoji-symbol { 
            font-size: 1.5rem; 
            margin-bottom: 5px; 
        }
        .emoji-score { 
            font-size: 0.8rem; 
            color: #888; 
        }
        
        .alerts-container { 
            max-height: 400px; 
            overflow-y: auto; 
        }
        .alert-item { 
            background: #2a2a2a; 
            padding: 12px; 
            margin: 8px 0; 
            border-radius: 6px; 
            border-left: 4px solid #4CAF50; 
        }
        .alert-item.moderate { border-left-color: #FFC107; }
        .alert-item.high { border-left-color: #FF9800; }
        .alert-item.severe { border-left-color: #F44336; }
        
        .alert-header { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin-bottom: 6px; 
        }
        .alert-level { 
            font-size: 0.8rem; 
            font-weight: 600; 
            padding: 3px 8px; 
            border-radius: 12px; 
            text-transform: uppercase; 
        }
        .alert-level.mild { background: #4CAF50; color: white; }
        .alert-level.moderate { background: #FFC107; color: black; }
        .alert-level.high { background: #FF9800; color: white; }
        .alert-level.severe { background: #F44336; color: white; }
        
        .wellness-cards { 
            display: grid; 
            grid-template-columns: repeat(4, 1fr); 
            gap: 20px; 
            margin-top: 15px; 
        }
        .wellness-card { 
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%); 
            padding: 20px; 
            border-radius: 10px; 
            color: white; 
            text-align: center; 
        }
        .wellness-card h4 { 
            margin-bottom: 10px; 
            font-size: 1.1rem; 
        }
        .wellness-card p { 
            font-size: 0.9rem; 
            opacity: 0.9; 
        }
        
        .popup { 
            display: none; 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background: rgba(0,0,0,0.8); 
            z-index: 1000; 
        }
        .popup-content { 
            position: absolute; 
            top: 50%; 
            left: 50%; 
            transform: translate(-50%, -50%); 
            background: #1a1a1a; 
            padding: 30px; 
            border-radius: 12px; 
            border: 2px solid #F44336; 
            max-width: 500px; 
            width: 90%; 
            text-align: center; 
        }
        .popup h3 { 
            color: #F44336; 
            margin-bottom: 15px; 
        }
        .popup-buttons { 
            margin-top: 20px; 
            display: flex; 
            gap: 15px; 
            justify-content: center; 
        }
        .btn { 
            padding: 10px 20px; 
            border: none; 
            border-radius: 6px; 
            cursor: pointer; 
            font-weight: 600; 
            transition: all 0.3s ease; 
        }
        .btn-danger { 
            background: #F44336; 
            color: white; 
        }
        .btn-secondary { 
            background: #4CAF50; 
            color: white; 
        }
        .btn:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 4px 8px rgba(0,0,0,0.3); 
        }
        
        canvas { 
            max-height: 300px; 
        }
        
        .status-indicator { 
            position: fixed; 
            top: 20px; 
            right: 20px; 
            background: #4CAF50; 
            color: white; 
            padding: 8px 16px; 
            border-radius: 20px; 
            font-size: 0.9rem; 
            font-weight: 600; 
            z-index: 100; 
        }
        .status-indicator.disconnected { 
            background: #F44336; 
        }
        
        @media (max-width: 1400px) {
            .dashboard-grid { grid-template-columns: repeat(8, 1fr); }
            .research-panel, .stress-detection { grid-column: span 4; }
            .emoji-module, .temporal-analysis, .alerts-panel { grid-column: span 4; }
            .emotion-distribution, .model-evaluation { grid-column: span 4; }
        }
        
        @media (max-width: 1000px) {
            .dashboard-grid { grid-template-columns: repeat(4, 1fr); }
            .research-panel, .stress-detection, .emoji-module, .temporal-analysis, .alerts-panel, .emotion-distribution, .model-evaluation, .dataset-sentiment, .burnout-distribution, .sentiment-analysis, .temporal-recommendations, .user-input-panel, .user-stress-chart { grid-column: span 4; }
            .live-analysis-panel { grid-column: span 4; }
            .stats-bar { grid-template-columns: repeat(2, 1fr); }
            .wellness-cards { grid-template-columns: repeat(2, 1fr); }
        }
        
        @media (max-width: 600px) {
            .dashboard-grid { grid-template-columns: 1fr; }
            .stats-bar { grid-template-columns: 1fr; }
            .wellness-cards { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="status-indicator" id="connectionStatus">🔴 Disconnected</div>
    
    <div class="header">
        <h1>🧠 Early Stress & Burnout Detection from Social Media Text</h1>
        <p>Powered by NLP + Emoji Sentiment + Real-time Alerts</p>
        
        <div class="stats-bar">
            <div class="stat-card">
                <div class="stat-value" id="totalPosts">15,847</div>
                <div class="stat-label">📘 Total Posts Analyzed</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="usersTracked">3,421</div>
                <div class="stat-label">🧍♀️ Users Tracked</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="datasetsUsed">5</div>
                <div class="stat-label">🔍 Datasets Used</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="modelAccuracy">92.3%</div>
                <div class="stat-label">🎯 Model Accuracy</div>
            </div>
        </div>
    </div>
    
    <div class="dashboard-grid">
        <!-- Research Benchmark Panel -->
        <div class="panel research-panel">
            <h3>📚 Research Benchmark Panel</h3>
            <table class="research-table" id="researchTable">
                <thead>
                    <tr>
                        <th>Study</th>
                        <th>Dataset</th>
                        <th>Model</th>
                        <th>Accuracy</th>
                        <th>Limitation</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
        
        <!-- Stress & Burnout Detection -->
        <div class="panel stress-detection">
            <h3>🎯 Stress & Burnout Detection</h3>
            <div style="display: flex; flex-direction: column; gap: 20px;">
                <div>
                    <div class="gauge-container">
                        <div class="gauge">
                            <div class="gauge-needle" id="stressNeedle"></div>
                        </div>
                    </div>
                    <div class="stress-level-text">
                        <strong>Current Stress Level: <span id="stressLevel">Moderate</span></strong>
                    </div>
                </div>
                <div style="height: 200px;">
                    <canvas id="sentimentChart"></canvas>
                </div>
            </div>
        </div>
        
        <!-- Emoji Seriousness Detection -->
        <div class="panel emoji-module">
            <h3>😊 Emoji Seriousness Detection</h3>
            <div class="emoji-grid" id="emojiGrid"></div>
        </div>
        
        <!-- Temporal Behavior Analysis -->
        <div class="panel temporal-analysis">
            <h3>⏰ Temporal Behavior Analysis</h3>
            <canvas id="temporalChart"></canvas>
        </div>
        
        <!-- Real-time Alerts -->
        <div class="panel alerts-panel">
            <h3>🚨 Real-time Alert System</h3>
            <div style="background: rgba(244, 67, 54, 0.1); padding: 10px; border-radius: 6px; margin-bottom: 15px; border: 1px solid #F44336;">
                <strong style="color: #F44336;">🔴 High-Stress Alert: <span id="alertPercentage">12%</span> of recent posts</strong>
            </div>
            <div class="alerts-container" id="alertsContainer">
                <div style="text-align: center; color: #666; padding: 20px;">
                    Monitoring for real-time alerts...
                </div>
            </div>
        </div>
        
        <!-- Emotion Distribution -->
        <div class="panel emotion-distribution">
            <h3>💭 Emotion Distribution & Lexicon Insights</h3>
            <canvas id="emotionChart"></canvas>
        </div>
        
        <!-- Dataset Sentiment Distribution -->
        <div class="panel dataset-sentiment">
            <h3>📊 Dataset Sentiment Distribution</h3>
            <canvas id="datasetSentimentChart"></canvas>
        </div>
        
        <!-- Burnout Distribution -->
        <div class="panel burnout-distribution">
            <h3>🔥 Burnout Distribution</h3>
            <canvas id="burnoutChart"></canvas>
        </div>
        
        <!-- Model Evaluation -->
        <div class="panel model-evaluation">
            <h3>📊 Model Evaluation Panel</h3>
            <canvas id="modelChart"></canvas>
        </div>
        
        <!-- Sentiment Analysis -->
        <div class="panel sentiment-analysis">
            <h3>📊 Sentiment Analysis</h3>
            <canvas id="sentimentAnalysisChart"></canvas>
        </div>
        
        <!-- Temporal Recommendations -->
        <div class="panel temporal-recommendations">
            <h3>⏰ Temporal Recommendations</h3>
            <div class="wellness-cards" style="grid-template-columns: repeat(2, 1fr);">
                <div class="wellness-card" style="background: linear-gradient(135deg, #FF9800 0%, #F57C00 100%);">
                    <h4>🌅 Morning</h4>
                    <p id="morningRec">Start your day with 5 minutes of deep breathing</p>
                </div>
                <div class="wellness-card" style="background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%);">
                    <h4>☀️ Afternoon</h4>
                    <p id="afternoonRec">Take a 10-minute walk to reduce stress</p>
                </div>
                <div class="wellness-card" style="background: linear-gradient(135deg, #9C27B0 0%, #7B1FA2 100%);">
                    <h4>🌆 Evening</h4>
                    <p id="eveningRec">Practice gratitude journaling before bed</p>
                </div>
                <div class="wellness-card" style="background: linear-gradient(135deg, #3F51B5 0%, #303F9F 100%);">
                    <h4>🌙 Night</h4>
                    <p id="nightRec">Limit screen time 1 hour before sleep</p>
                </div>
            </div>
        </div>
        
        <!-- User Input Panel -->
        <div class="panel user-input-panel">
            <h3>📝 How Are You Feeling?</h3>
            <div style="margin-bottom: 15px;">
                <textarea id="userInput" placeholder="Share how you're feeling right now... (e.g., 'I'm stressed about work deadlines 😩')" 
                    style="width: 100%; height: 80px; background: #2a2a2a; border: 1px solid #444; border-radius: 6px; padding: 10px; color: #e8e8e8; font-family: inherit; resize: vertical;"></textarea>
            </div>
            <button onclick="analyzeUserInput()" style="background: #4CAF50; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-weight: 600;">
                🔍 Analyze My Feelings
            </button>
            <div id="userAnalysisResult" style="margin-top: 15px; padding: 10px; background: #2a2a2a; border-radius: 6px; display: none;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span id="userStressLevel" class="alert-level"></span>
                    <span id="userTimestamp" style="color: #888; font-size: 0.8rem;"></span>
                </div>
                <div id="userText" style="margin: 8px 0; font-style: italic;"></div>
                <div id="userScore" style="color: #888; font-size: 0.8rem;"></div>
            </div>
        </div>
        
        <!-- User Stress History Chart -->
        <div class="panel user-stress-chart">
            <h3>📈 Your Stress History</h3>
            <canvas id="userStressChart"></canvas>
        </div>
        
        <!-- Live Alert Analysis -->
        <div class="panel live-analysis-panel">
            <h3>🔴 Live Alert Analysis</h3>
            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 20px;">
                <div class="stat-card" style="background: rgba(76, 175, 80, 0.1); border: 1px solid #4CAF50;">
                    <div class="stat-value" id="totalAlerts">0</div>
                    <div class="stat-label">📊 Total Alerts</div>
                </div>
                <div class="stat-card" style="background: rgba(255, 152, 0, 0.1); border: 1px solid #FF9800;">
                    <div class="stat-value" id="avgStressScore">0.0</div>
                    <div class="stat-label">🎯 Avg Stress Score</div>
                </div>
                <div class="stat-card" style="background: rgba(244, 67, 54, 0.1); border: 1px solid #F44336;">
                    <div class="stat-value" id="criticalAlerts">0</div>
                    <div class="stat-label">⚠️ Critical Alerts</div>
                </div>
                <div class="stat-card" style="background: rgba(33, 150, 243, 0.1); border: 1px solid #2196F3;">
                    <div class="stat-value" id="trendDirection">→</div>
                    <div class="stat-label">📈 Trend</div>
                </div>
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div>
                    <h4 style="color: #4CAF50; margin-bottom: 10px;">📊 Stress Level Distribution</h4>
                    <canvas id="levelDistributionChart" style="max-height: 200px;"></canvas>
                </div>
                <div>
                    <h4 style="color: #4CAF50; margin-bottom: 10px;">📱 Source Distribution</h4>
                    <canvas id="sourceDistributionChart" style="max-height: 200px;"></canvas>
                </div>
            </div>
        </div>
        
        <!-- Wellness Panel -->
        <div class="panel wellness-panel">
            <h3>🌟 Wellness Recommendations</h3>
            <div class="wellness-cards">
                <div class="wellness-card">
                    <h4>💡 Current Tip</h4>
                    <p id="currentTip">Take a quick mental break</p>
                </div>
                <div class="wellness-card">
                    <h4>🧘 Mindfulness</h4>
                    <p>"Practice gratitude - name 3 things you're thankful for"</p>
                </div>
                <div class="wellness-card">
                    <h4>🎵 Music Therapy</h4>
                    <p><a href="https://open.spotify.com/playlist/37i9dQZF1DWU0ScTcjJBdj" target="_blank" style="color: white;">Calming Playlist</a></p>
                </div>
                <div class="wellness-card">
                    <h4>📈 Progress</h4>
                    <p id="progressText">"Your stress levels are being monitored"</p>
                </div>
            </div>
        </div>
    </div>

    <div class="popup" id="criticalPopup">
        <div class="popup-content">
            <h3>🚨 Critical Mental Health Alert</h3>
            <p id="popupMessage">Severe stress or burnout detected</p>
            <div class="popup-buttons">
                <button class="btn btn-danger" onclick="getHelp()">🆘 Crisis Helpline (988)</button>
                <button class="btn btn-secondary" onclick="closePopup()">Dismiss</button>
            </div>
        </div>
    </div>

    <script>
        // Initialize charts
        const sentimentChart = new Chart(document.getElementById('sentimentChart'), {
            type: 'pie',
            data: {
                labels: ['Positive', 'Neutral', 'Negative'],
                datasets: [{
                    data: [30, 45, 25],
                    backgroundColor: ['#4CAF50', '#FFC107', '#F44336']
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { labels: { color: '#e8e8e8' } } }
            }
        });

        const temporalChart = new Chart(document.getElementById('temporalChart'), {
            type: 'line',
            data: {
                labels: ['00:00', '04:00', '08:00', '12:00', '16:00', '20:00'],
                datasets: [{
                    label: 'Stress Level',
                    data: [0.3, 0.2, 0.4, 0.6, 0.7, 0.8],
                    borderColor: '#4CAF50',
                    backgroundColor: 'rgba(76, 175, 80, 0.1)',
                    fill: true
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { labels: { color: '#e8e8e8' } } },
                scales: {
                    x: { ticks: { color: '#888' }, grid: { color: '#333' } },
                    y: { ticks: { color: '#888' }, grid: { color: '#333' } }
                }
            }
        });

        const emotionChart = new Chart(document.getElementById('emotionChart'), {
            type: 'radar',
            data: {
                labels: ['Joy', 'Anger', 'Sadness', 'Fear', 'Disgust', 'Surprise', 'Trust', 'Anticipation'],
                datasets: [{
                    label: 'Emotion Distribution',
                    data: [15, 25, 30, 20, 10, 8, 12, 18],
                    borderColor: '#4CAF50',
                    backgroundColor: 'rgba(76, 175, 80, 0.2)'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { labels: { color: '#e8e8e8' } } },
                scales: {
                    r: { 
                        ticks: { color: '#888' }, 
                        grid: { color: '#333' },
                        pointLabels: { color: '#e8e8e8' }
                    }
                }
            }
        });

        const datasetSentimentChart = new Chart(document.getElementById('datasetSentimentChart'), {
            type: 'pie',
            data: {
                labels: ['Positive', 'Negative', 'Neutral'],
                datasets: [{
                    data: [25, 45, 30],
                    backgroundColor: ['#4CAF50', '#F44336', '#FFC107']
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { labels: { color: '#e8e8e8' } } }
            }
        });

        const burnoutChart = new Chart(document.getElementById('burnoutChart'), {
            type: 'bar',
            data: {
                labels: ['Work Overload', 'Lack of Control', 'Insufficient Reward', 'Workplace Community', 'Fairness Issues', 'Value Conflicts'],
                datasets: [{
                    label: 'Burnout Factors (%)',
                    data: [35, 28, 22, 18, 15, 12],
                    backgroundColor: ['#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7', '#DDA0DD']
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { labels: { color: '#e8e8e8' } } },
                scales: {
                    x: { ticks: { color: '#888' }, grid: { color: '#333' } },
                    y: { ticks: { color: '#888' }, grid: { color: '#333' } }
                }
            }
        });

        const sentimentAnalysisChart = new Chart(document.getElementById('sentimentAnalysisChart'), {
            type: 'doughnut',
            data: {
                labels: ['Positive', 'Negative', 'Neutral'],
                datasets: [{
                    data: [35, 40, 25],
                    backgroundColor: ['#4CAF50', '#F44336', '#FFC107'],
                    borderWidth: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { 
                    legend: { 
                        labels: { color: '#e8e8e8' },
                        position: 'bottom'
                    }
                },
                cutout: '60%'
            }
        });

        const userStressChart = new Chart(document.getElementById('userStressChart'), {
            type: 'line',
            data: {
                labels: [],
                datasets: [{
                    label: 'Your Stress Level',
                    data: [],
                    borderColor: '#FF6B6B',
                    backgroundColor: 'rgba(255, 107, 107, 0.1)',
                    fill: true,
                    tension: 0.4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { labels: { color: '#e8e8e8' } } },
                scales: {
                    x: { ticks: { color: '#888' }, grid: { color: '#333' } },
                    y: { 
                        ticks: { color: '#888' }, 
                        grid: { color: '#333' },
                        min: 0,
                        max: 1
                    }
                }
            }
        });

        const levelDistributionChart = new Chart(document.getElementById('levelDistributionChart'), {
            type: 'doughnut',
            data: {
                labels: ['Mild', 'Moderate', 'High', 'Severe'],
                datasets: [{
                    data: [0, 0, 0, 0],
                    backgroundColor: ['#4CAF50', '#FFC107', '#FF9800', '#F44336']
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { labels: { color: '#e8e8e8' }, position: 'bottom' } }
            }
        });

        const sourceDistributionChart = new Chart(document.getElementById('sourceDistributionChart'), {
            type: 'bar',
            data: {
                labels: ['Reddit', 'Twitter', 'Survey', 'Forum'],
                datasets: [{
                    data: [0, 0, 0, 0],
                    backgroundColor: ['#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4']
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: {
                    x: { ticks: { color: '#888' }, grid: { color: '#333' } },
                    y: { ticks: { color: '#888' }, grid: { color: '#333' } }
                }
            }
        });

        const modelChart = new Chart(document.getElementById('modelChart'), {
            type: 'bar',
            data: {
                labels: ['BERT', 'RoBERTa', 'BiLSTM', 'Hybrid'],
                datasets: [{
                    label: 'Accuracy %',
                    data: [89, 91, 88, 92],
                    backgroundColor: ['#4CAF50', '#2196F3', '#FF9800', '#9C27B0']
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { labels: { color: '#e8e8e8' } } },
                scales: {
                    x: { ticks: { color: '#888' }, grid: { color: '#333' } },
                    y: { ticks: { color: '#888' }, grid: { color: '#333' } }
                }
            }
        });

        // WebSocket connection
        const socket = io();
        
        socket.on('connect', function() {
            document.getElementById('connectionStatus').className = 'status-indicator';
            document.getElementById('connectionStatus').textContent = '🟢 Live Monitoring Active';
        });
        
        socket.on('disconnect', function() {
            document.getElementById('connectionStatus').className = 'status-indicator disconnected';
            document.getElementById('connectionStatus').textContent = '🔴 Disconnected';
        });
        
        socket.on('system_data', function(data) {
            // Update stats
            document.getElementById('totalPosts').textContent = data.stats.total_posts.toLocaleString();
            document.getElementById('usersTracked').textContent = data.stats.users_tracked.toLocaleString();
            document.getElementById('datasetsUsed').textContent = data.stats.datasets_used;
            document.getElementById('modelAccuracy').textContent = data.stats.model_accuracy + '%';
            
            // Update research table
            const tbody = document.querySelector('#researchTable tbody');
            tbody.innerHTML = '';
            data.research.forEach(study => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${study.study}</td>
                    <td>${study.dataset}</td>
                    <td>${study.model}</td>
                    <td>${study.accuracy}%</td>
                    <td>${study.limitation}</td>
                `;
            });
            
            // Update emoji grid
            const emojiGrid = document.getElementById('emojiGrid');
            emojiGrid.innerHTML = '';
            Object.entries(data.emojis).slice(0, 10).forEach(([emoji, data]) => {
                const emojiItem = document.createElement('div');
                emojiItem.className = 'emoji-item';
                emojiItem.innerHTML = `
                    <div class="emoji-symbol">${emoji}</div>
                    <div class="emoji-score">${data.sentiment.toFixed(2)}</div>
                `;
                emojiGrid.appendChild(emojiItem);
            });
            
            // Update dataset sentiment chart
            if (data.dataset_sentiment) {
                datasetSentimentChart.data.datasets[0].data = [
                    data.dataset_sentiment.positive,
                    data.dataset_sentiment.negative,
                    data.dataset_sentiment.neutral
                ];
                datasetSentimentChart.update();
            }
            
            // Update burnout distribution chart
            if (data.burnout_distribution) {
                burnoutChart.data.datasets[0].data = Object.values(data.burnout_distribution);
                burnoutChart.update();
            }
            
            // Update temporal recommendations
            if (data.temporal_recommendations) {
                document.getElementById('morningRec').textContent = data.temporal_recommendations.morning;
                document.getElementById('afternoonRec').textContent = data.temporal_recommendations.afternoon;
                document.getElementById('eveningRec').textContent = data.temporal_recommendations.evening;
                document.getElementById('nightRec').textContent = data.temporal_recommendations.night;
            }
            
            // Update wellness recommendations
            if (data.wellness_recommendations && data.wellness_recommendations.length > 0) {
                const randomTip = data.wellness_recommendations[Math.floor(Math.random() * data.wellness_recommendations.length)];
                document.getElementById('currentTip').textContent = randomTip;
            }
            
            // Update user stress chart
            if (data.user_stress_history) {
                userStressChart.data.labels = data.user_stress_history.timestamps;
                userStressChart.data.datasets[0].data = data.user_stress_history.stress_scores;
                userStressChart.update();
            }
        });
        
        socket.on('real_time_alert', function(alert) {
            const alertsContainer = document.getElementById('alertsContainer');
            
            // Clear placeholder
            if (alertsContainer.children.length === 1 && alertsContainer.children[0].textContent.includes('Monitoring')) {
                alertsContainer.innerHTML = '';
            }
            
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert-item ${alert.level.toLowerCase()}`;
            alertDiv.innerHTML = `
                <div class="alert-header">
                    <span class="alert-level ${alert.level.toLowerCase()}">${alert.level}</span>
                    <span style="color: #888; font-size: 0.8rem;">${alert.timestamp}</span>
                </div>
                <div style="font-size: 0.9rem; margin: 6px 0;">"${alert.text}"</div>
                <div style="font-size: 0.8rem; color: #888;">
                    Source: ${alert.source} | Score: ${alert.score.toFixed(2)} | User: ${alert.user_id}
                </div>
            `;
            
            alertsContainer.insertBefore(alertDiv, alertsContainer.firstChild);
            
            // Keep only last 10 alerts
            while (alertsContainer.children.length > 10) {
                alertsContainer.removeChild(alertsContainer.lastChild);
            }
            
            // Update stress gauge
            const stressNeedle = document.getElementById('stressNeedle');
            const rotation = (alert.score * 180) - 90; // Convert 0-1 to -90 to 90 degrees
            stressNeedle.style.transform = `translateX(-50%) rotate(${rotation}deg)`;
            
            document.getElementById('stressLevel').textContent = alert.level;
            
            // Show critical popup
            if (alert.is_critical) {
                document.getElementById('popupMessage').textContent = 
                    `${alert.level} stress detected: "${alert.text}"`;
                document.getElementById('criticalPopup').style.display = 'block';
                
                // Flash effect
                document.body.style.border = '3px solid #F44336';
                setTimeout(() => document.body.style.border = 'none', 2000);
            }
        });
        
        socket.on('stats_update', function(stats) {
            document.getElementById('totalPosts').textContent = stats.total_posts.toLocaleString();
            
            // Calculate percentage based on recent posts
            const percentage = stats.recent_posts > 0 ? 
                Math.round((stats.recent_high_stress / stats.recent_posts) * 100) : 0;
            document.getElementById('alertPercentage').textContent = percentage + '%';
            
            document.getElementById('progressText').textContent = 
                `Analyzed ${stats.total_posts} posts with ${stats.high_stress_alerts} high-risk alerts`;
        });
        
        function closePopup() {
            document.getElementById('criticalPopup').style.display = 'none';
        }
        
        function getHelp() {
            window.open('tel:988', '_blank');
            closePopup();
        }
        
        function analyzeUserInput() {
            const userText = document.getElementById('userInput').value.trim();
            if (!userText) {
                alert('Please enter how you\'re feeling first!');
                return;
            }
            
            socket.emit('user_input', { text: userText });
            document.getElementById('userInput').value = '';
        }
        
        socket.on('user_analysis_result', function(result) {
            // Show analysis result
            const resultDiv = document.getElementById('userAnalysisResult');
            const levelSpan = document.getElementById('userStressLevel');
            
            levelSpan.textContent = result.level;
            levelSpan.className = `alert-level ${result.level.toLowerCase()}`;
            
            document.getElementById('userTimestamp').textContent = result.timestamp;
            document.getElementById('userText').textContent = `"${result.text}"`;
            document.getElementById('userScore').textContent = `Stress Score: ${result.score.toFixed(2)}`;
            
            resultDiv.style.display = 'block';
            
            // Update user stress chart
            userStressChart.data.labels = result.history.timestamps;
            userStressChart.data.datasets[0].data = result.history.stress_scores;
            userStressChart.update();
            
            // Show critical popup if needed
            if (result.is_critical) {
                document.getElementById('popupMessage').textContent = 
                    `Your stress level is ${result.level}. Consider seeking support.`;
                document.getElementById('criticalPopup').style.display = 'block';
            }
        });
        
        socket.on('live_analysis_update', function(analysis) {
            // Update live analysis stats
            document.getElementById('totalAlerts').textContent = analysis.total_alerts;
            document.getElementById('avgStressScore').textContent = analysis.avg_stress_score.toFixed(2);
            document.getElementById('criticalAlerts').textContent = analysis.critical_alerts;
            
            // Update trend direction
            const trend = analysis.recent_trend;
            if (trend.length >= 2) {
                const recent = trend.slice(-5).reduce((a, b) => a + b, 0) / Math.min(5, trend.length);
                const earlier = trend.slice(-10, -5).reduce((a, b) => a + b, 0) / Math.min(5, trend.slice(-10, -5).length);
                const direction = recent > earlier ? '↗️' : recent < earlier ? '↘️' : '→';
                document.getElementById('trendDirection').textContent = direction;
            }
            
            // Update level distribution chart
            levelDistributionChart.data.datasets[0].data = [
                analysis.level_counts.Mild,
                analysis.level_counts.Moderate,
                analysis.level_counts.High,
                analysis.level_counts.Severe
            ];
            levelDistributionChart.update();
            
            // Update source distribution chart
            sourceDistributionChart.data.datasets[0].data = [
                analysis.source_counts.Reddit,
                analysis.source_counts.Twitter,
                analysis.source_counts.Survey,
                analysis.source_counts.Forum
            ];
            sourceDistributionChart.update();
        });
        
        // Allow Enter key to submit
        document.getElementById('userInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                analyzeUserInput();
            }
        });
    </script>
</body>
</html>